name: Exibir informações da Issue

on:
  issues:
    types: [opened, edited]

jobs:
  mostrar-info:
    runs-on: ubuntu-latest
    env:
      NOME_ARQUIVO: issue_data.json
    steps:
      - name: Verificar checkout do repositório
        uses: actions/checkout@v4

      - name: Converter issue para JSON
        uses: zentered/issue-forms-body-parser@v2.0.0
        id: parse

      - name: Salvar dados da issue em um arquivo
        run: |
          echo '${{ steps.parse.outputs.data }}' > $NOME_ARQUIVO

      - name: Instalar dependências
        run: |
          pip install jsonschema

      # Teste para validar_evento.py, que retorna 0 se válido e 1 se inválido. Valida o arquivo issue_data.json e label
      - name: Validar evento na issue
        run: |
          python3 script/validar_evento.py >> $GITHUB_OUTPUT
          if [$GITHUB_OUTPUT == 1]; then
            echo "A issue não é válida."
            exit 1
          else
            echo "A issue é válida."
          fi
  
      - name: Executar script py
        run: |
          echo "A issue contém a label 'evento:adicionar'."
          python3 script/adicionar_evento.py ${NOME_ARQUIVO}
         

      
